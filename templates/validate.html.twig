<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Votre Panier</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>ðŸ›’</text></svg>">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    {% block javascripts %}
        {% block importmap %}
            {{ importmap('app') }}
        {% endblock %}
    {% endblock %}
</head>

<body>
    {% include 'navbar.html.twig' %}

    <div class="container mt-5">
        <h1 class="text-center">Votre Panier</h1>

        {% if cartItems is not empty %}
            <div class="row">
                <div class="col-md-8">
                    <div class="list-group">
                        {% set total = 0 %}
                        {% for articleId, item in cartItems %}
                            {% set subtotal = item.quantity * item.article.prix %}
                            {% set total = total + subtotal %}

                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <h5 class="mb-1">{{ item.article.nom }}</h5>
                                    <p class="mb-1">{{ item.quantity }} x {{ item.article.prix }}â‚¬</p>
                                </div>
                                <div>
                                    <form action="{{ path('cart_add', {'id': articleId}) }}" method="post" class="d-inline">
                                        <button type="submit" class="btn btn-sm btn-primary">+</button>
                                    </form>
                                    <form action="{{ path('cart_remove', {'id': articleId}) }}" method="post" class="d-inline">
                                        <button type="submit" class="btn btn-sm btn-danger">-</button>
                                    </form>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card shadow-lg">
                        <div class="card-header bg-success text-white text-center">
                            <h4>Total du panier</h4>
                        </div>
                        <div class="card-body text-center">
                            <h2>{{ total }}â‚¬</h2>
                        </div>
                        <div class="card-footer text-center">
                            <a href="{{ path('cart_validate') }}" class="btn btn-warning w-100">Valider l'achat</a>
                        </div>
                    </div>
                </div>
            </div>
        {% else %}
            <p class="text-center text-muted">Votre panier est vide.</p>
        {% endif %}
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
